# Epic and Story Structure

## Epic Approach

**Epic Structure Decision**: **단일 종합 Epic 접근법** - 반복 일정 기능의 모든 구성 요소들(Event 타입 확장, UI 통합, 복잡한 날짜 로직)이 상호 의존적이고 기존 캘린더 시스템과 통합되어야 하므로 분할하지 않고 하나의 Epic으로 관리하여 **기능 일관성과 통합 테스트 용이성을 보장**

## Epic 1: 반복 일정 관리 시스템

**Epic Goal**: 기존 캘린더 애플리케이션에 TDD 방식으로 반복 일정 기능을 추가하여, 사용자가 매일/매주/매월/매년 반복되는 일정을 효율적으로 관리할 수 있도록 하되, **31일 매월 반복, 윤년 29일 매년 반복 등 해당 날짜가 없는 경우 이벤트 생성을 스킵**한다.

**Integration Requirements**: 
- Event 타입 `repeat` 필드 확장 시 기존 이벤트 데이터 100% 호환성 보장
- useEventOperations 등 커스텀 훅 확장 시 기존 CRUD 성능 저하 10% 미만 유지  
- MSW 테스트 환경에서 모든 반복 시나리오 재현 가능하도록 핸들러 확장

### Story 1.1: 반복 일정 기본 설정 및 생성

**의존성**: 없음 (시작점)
**후속 스토리에 제공**: Event 타입 확장, 반복 로직, 데이터 구조

As a 캘린더 사용자,
I want 이벤트 생성 시 반복 유형과 종료 조건을 설정할 수 있다,
so that 반복되는 일정을 매번 개별로 생성하지 않고 한 번에 관리할 수 있다.

**Acceptance Criteria**:
1. EventForm에 반복 설정 토글 스위치 추가 (기존 폼 레이아웃 유지)
2. 반복 유형 선택: 매일/매주/매월/매년 드롭다운
3. 반복 종료 날짜: 2025-10-30까지 제한된 날짜 선택기
4. **엣지 케이스 처리 (스킵 방식)**:
   - 31일 매월 반복: 31일이 없는 달에는 해당 월 이벤트 생성 스킵
   - 윤년 2월 29일 매년 반복: 평년에는 해당 연도 이벤트 생성 스킵
   - 날짜 유효성 검증: `isActualDateExists()` 함수로 실제 날짜 존재 여부 체크
5. 반복 일정들은 `repeat.id` UUID로 그룹핑하여 JSON 저장

**Integration Verification**:
- IV1: 기존 단일 이벤트 생성 응답시간 증가 10% 미만 확인
- IV2: 기존 Event 타입 사용 코드 컴파일 에러 0개 확인  
- IV3: useEventOperations 기존 인터페이스 100% 호환성 확인

### Story 1.2: 반복 일정 시각적 구분 및 캘린더 통합

**의존성**: Story 1.1 (`repeat.id` 필드 존재 필요)
**후속 스토리에 제공**: 반복 일정 식별 UI, 사용자 인터랙션 기반

As a 캘린더 사용자,
I want 캘린더 뷰에서 반복 일정을 시각적으로 구분할 수 있다,
so that 어떤 일정이 반복 일정인지 한눈에 파악할 수 있다.

**Acceptance Criteria**:
1. 반복 일정 아이콘: 🔄 (우측 상단, 12px, opacity 0.7)
2. 월 뷰/주 뷰 일관된 아이콘 표시 위치와 크기
3. **반복 정보 표시 (스킵 정보 포함)**:
   - 기본: "매월 반복, 2025-10-30까지"
   - 스킵 있는 경우: "31일 매월 반복 (일부 월 제외), 2025-10-30까지"
   - 스킵 개수: "총 12개월 중 7개월에 생성됨"
4. 아이콘 색상: 중성 그레이 (#666) - 기존 카테고리 색상과 구분
5. 호버 시 반복 패턴별 툴팁: "매월 반복" 또는 "매월 반복 (31일 - 일부 월 제외)"

**Integration Verification**:  
- IV1: 기존 일반 이벤트 렌더링 성능 영향 5% 미만 확인
- IV2: 캘린더 그리드 레이아웃 왜곡 0건 확인
- IV3: 월/주 뷰 전환 시 아이콘 위치 일관성 100% 확인

### Story 1.3: 반복 일정 개별 관리

**의존성**: Story 1.1 (반복 로직) + Story 1.2 (UI 식별)
**후속 스토리**: 없음 (완료)

As a 캘린더 사용자,
I want 반복 일정 중 특정 일정만 개별 수정/삭제할 수 있다,
so that 전체 반복을 해치지 않고 예외적인 상황을 처리할 수 있다.

**Acceptance Criteria**:
1. 반복 일정 수정 시 모달: "이 일정만 수정" vs "전체 반복 수정" 선택
2. 개별 수정: `repeat.id` 제거 + 독립 이벤트 전환 + 아이콘 제거
3. 반복 일정 삭제 시 모달 **스킵 정보 포함**: "전체 시리즈 12개 중 7개 일정이 삭제됩니다 (일부 월 제외로 5개는 존재하지 않음)"
4. 개별 삭제: 해당 이벤트만 제거, 나머지 반복 유지 (스킵된 날짜들도 스킵 상태 유지)
5. 데이터 일관성 보장: 모든 조작을 원자적 트랜잭션으로 처리

**Integration Verification**:
- IV1: 기존 일반 이벤트 수정/삭제 워크플로우 영향도 0% 확인
- IV2: 반복 일정 조작 후 useEventOperations 상태 일관성 100% 확인  
- IV3: MSW 테스트에서 모든 반복 시나리오 재현 가능성 확인